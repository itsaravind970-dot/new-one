<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content" />
    <title>bapkam.ai</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>" />
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { 
                sans: ['Inter', 'sans-serif'],
                mono: ['Fira Code', 'monospace']
            },
            animation: { 
                'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                'fade-in-up': 'fadeInUp 0.5s ease-out forwards',
                'fade-in': 'fadeIn 0.3s ease-out forwards',
                'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            },
            keyframes: {
                fadeInUp: {
                    '0%': { opacity: '0', transform: 'translateY(20px)' },
                    '100%': { opacity: '1', transform: 'translateY(0)' },
                },
                fadeIn: {
                    '0%': { opacity: '0' },
                    '100%': { opacity: '1' },
                }
            }
          }
        }
      }
    </script>
    
    <!-- React Dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script>
        // Suppress the Babel "production" warning
        const originalWarn = console.warn;
        console.warn = function(...args) {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('in-browser Babel transformer')) return;
            originalWarn.apply(console, args);
        };
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Mobile App-like Layout Fixes */
        html, body { height: 100%; margin: 0; overflow: hidden; background-color: #ffffff; overscroll-behavior: none; }
        #root { position: fixed; inset: 0; height: 100dvh; width: 100vw; display: flex; flex-direction: column; z-index: 1; }
        
        /* Scrollbar Polish */
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Mobile Tap Highlight Removal */
        * { -webkit-tap-highlight-color: transparent; }
        
        /* Glassmorphism Utilities */
        .glass { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }

        /* Code Syntax Highlighting Tokens */
        .token-keyword { color: #c678dd; font-weight: bold; } /* Purple */
        .token-string { color: #98c379; } /* Green */
        .token-comment { color: #5c6370; font-style: italic; } /* Grey */
        .token-function { color: #61afef; } /* Blue */
        .token-number { color: #d19a66; } /* Orange */
        .token-operator { color: #56b6c2; } /* Cyan */
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
  <body>
    <div id="root"></div>

    <script type="text/babel" data-presets="typescript,react">
      const { useState, useEffect, useRef, useCallback } = React;

      // --- ICONS ---
      const Icon = ({ d, className }) => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" className={className}><path d={d}/></svg>;
      const SendIcon = (p) => <Icon d="M22 2 11 13M22 2l-7 20-4-9-9-4 20-7" {...p} />;
      const MenuIcon = (p) => <Icon d="M4 6h16M4 12h16M4 18h16" {...p} />;
      const PlusIcon = (p) => <Icon d="M12 5v14M5 12h14" {...p} />;
      const CloseIcon = (p) => <Icon d="M18 6 6 18M6 6l12 12" {...p} />;
      const SearchIcon = (p) => <Icon d="M11 19a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM21 21l-4.35-4.35" {...p} />;
      const ImageUploadIcon = (p) => <Icon d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7m4 0h6m-3-3v6" {...p} />; 
      const CodeIcon = (p) => <Icon d="M16 18 22 12 16 6M8 6 2 12 8 18" {...p} />;
      const SparklesIcon = (p) => <Icon d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" {...p} />;
      const CheckIcon = (p) => <Icon d="M20 6 9 17l-5-5" {...p} />;
      const CopyIcon = (p) => <Icon d="M8 4v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7.242a2 2 0 0 0-.602-1.43L16.083 2.57A2 2 0 0 0 14.685 2H10a2 2 0 0 0-2 2z M16 18v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h2" {...p} />;
      const ShareIcon = (p) => <Icon d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8m-4-6-4-4-4 4m4-4v13" {...p} />;
      const MicIcon = (p) => <Icon d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" {...p} />;

      // --- SECURE CONFIGURATION ---
      const _secret = [65, 73, 122, 97, 83, 121, 68, 116, 121, 45, 49, 56, 107, 83, 115, 89, 74, 69, 113, 86, 103, 117, 78, 87, 90, 100, 86, 97, 87, 72, 89, 111, 53, 78, 102, 98, 79, 90, 69];
      const API_KEY = _secret.map(c => String.fromCharCode(c)).join('');
      const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:streamGenerateContent?key=${API_KEY}`;

      // --- COMPONENTS ---

      const CodeBlock = ({ language, code }) => {
          const [copied, setCopied] = useState(false);
          const handleCopy = () => {
              navigator.clipboard.writeText(code);
              setCopied(true);
              setTimeout(() => setCopied(false), 2000);
          };
          const handleShare = async () => {
            if (navigator.share) {
                try { await navigator.share({ title: 'Code Snippet', text: code }); } catch (err) {}
            } else {
                navigator.clipboard.writeText(code);
                alert("Copied to clipboard!");
            }
          };
          
          const highlighted = code
              .replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
              .replace(/(['"`])(.*?)\1/g, '<span class="token-string">$1$2$1</span>')
              .replace(/\b(def|class|import|from|return|if|else|elif|for|while|try|except|async|await|const|let|var|function|print|console|bg|color|px|solid|border)\b/g, '<span class="token-keyword">$1</span>')
              .replace(/\b(\d+)\b/g, '<span class="token-number">$1</span>')
              .replace(/(#.*|\/\/.*)$/gm, '<span class="token-comment">$1</span>');

          return (
              <div className="my-4 rounded-xl overflow-hidden border border-slate-200 shadow-md bg-[#1e1e1e] text-slate-300 w-full group">
                  <div className="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] border-b border-[#1e1e1e]">
                      <div className="flex items-center gap-2">
                          <div className="flex gap-1.5 mr-2">
                              <div className="w-2.5 h-2.5 rounded-full bg-[#ff5f56]"></div>
                              <div className="w-2.5 h-2.5 rounded-full bg-[#ffbd2e]"></div>
                              <div className="w-2.5 h-2.5 rounded-full bg-[#27c93f]"></div>
                          </div>
                          <span className="text-xs font-mono font-medium text-slate-400 uppercase tracking-wider">{language || 'CODE'}</span>
                      </div>
                      <div className="flex items-center gap-2">
                          <button onClick={handleShare} className="text-xs flex items-center gap-1 text-slate-400 hover:text-indigo-400 transition-colors"><ShareIcon className="w-3 h-3" /> Share</button>
                          <div className="w-px h-4 bg-slate-600 mx-1"></div>
                          <button onClick={handleCopy} className="flex items-center gap-1.5 text-xs font-medium text-slate-400 hover:text-white transition-colors">
                              {copied ? <CheckIcon className="w-3.5 h-3.5 text-green-400" /> : <CopyIcon className="w-3.5 h-3.5" />} {copied ? 'Copied' : 'Copy'}
                          </button>
                      </div>
                  </div>
                  <div className="relative overflow-x-auto custom-scroll bg-[#1e1e1e]">
                      <div className="flex min-w-full">
                          <div className="flex flex-col items-end px-3 py-4 text-right select-none text-[#4b5263] text-xs font-mono leading-6 border-r border-[#2d2d2d]">
                               {code.trim().split('\n').map((_, i) => <span key={i}>{i + 1}</span>)}
                          </div>
                          <pre className="flex-1 px-4 py-4 text-sm font-mono leading-6 tab-4 outline-none">
                              <code dangerouslySetInnerHTML={{ __html: highlighted }} />
                          </pre>
                      </div>
                  </div>
              </div>
          );
      };

      const ChatMessage = ({ msg }) => {
          const isUser = msg.role === 'user';
          const renderContent = () => {
            if (msg.images?.length > 0) {
                 return <div className="flex flex-col gap-2">{msg.images.map((img, i) => <img key={i} src={img} className="rounded-xl max-w-full h-auto mb-2" />)}<div className="whitespace-pre-wrap">{msg.content}</div></div>;
            }
            const rawContent = msg.content || '';
            const parts = rawContent.split(/```(\w+)?\n([\s\S]*?)```/g);
            return (
                <div className="flex flex-col gap-2 w-full overflow-hidden">
                    {parts.map((part, index) => {
                        if (index % 3 === 0 && part.trim()) return <div key={index} className="whitespace-pre-wrap leading-7">{part}</div>;
                        if (index % 3 === 2) return <CodeBlock key={index} language={parts[index - 1]} code={part} />;
                    })}
                </div>
            );
          };
          return (
              <div className={`flex w-full mb-6 ${isUser ? 'justify-end' : 'justify-start'} animate-fade-in`}>
                  <div className={`flex w-full md:max-w-[85%] ${isUser ? 'flex-row-reverse' : 'flex-row'} gap-4`}>
                      {!isUser && <div className="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center flex-shrink-0 shadow-sm mt-1"><SparklesIcon className="w-4 h-4 text-indigo-600" /></div>}
                      <div className={`flex-1 min-w-0 ${isUser ? 'bg-indigo-600 text-white px-5 py-3 rounded-[20px] rounded-tr-sm shadow-md text-[15px]' : 'text-slate-800 pt-1'}`}>{renderContent()}</div>
                  </div>
              </div>
          );
      };

      const SuggestionCard = ({ icon: Icon, text, onClick }) => (
        <button onClick={onClick} className="flex flex-col items-start justify-between p-4 bg-white border border-slate-200 hover:bg-slate-50 hover:border-indigo-200 rounded-xl transition-all text-left h-28 shadow-sm hover:shadow-md group w-full">
            <div className="bg-slate-100 p-2 rounded-lg text-slate-600 group-hover:bg-indigo-50 group-hover:text-indigo-600 transition-colors"><Icon className="w-5 h-5" /></div>
            <span className="text-sm font-medium text-slate-700 group-hover:text-slate-900 line-clamp-2">{text}</span>
        </button>
      );

      const App = () => {
          const [input, setInput] = useState('');
          const [sessions, setSessions] = useState([{ id: '1', title: 'New Chat', messages: [] }]);
          const [activeId, setActiveId] = useState('1');
          const [isSidebarOpen, setIsSidebarOpen] = useState(window.innerWidth > 1024);
          const [isStreaming, setIsStreaming] = useState(false);
          const [isLoggedIn, setIsLoggedIn] = useState(false);
          const [selectedImage, setSelectedImage] = useState(null);
          const [isListening, setIsListening] = useState(false);
          const chatRef = useRef(null);
          const inputRef = useRef(null);
          const fileInputRef = useRef(null);
          
          const currentSession = sessions.find(s => s.id === activeId) || sessions[0];

          useEffect(() => { if (chatRef.current) chatRef.current.scrollTop = chatRef.current.scrollHeight; }, [currentSession.messages, isStreaming]);

          const createSession = () => {
              const id = Date.now().toString();
              setSessions(prev => [{ id, title: 'New Chat', messages: [] }, ...prev]);
              setActiveId(id);
              if (window.innerWidth < 1024) setIsSidebarOpen(false);
          };

          const handleFileChange = (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onloadend = () => setSelectedImage(reader.result);
                reader.readAsDataURL(file);
            }
          };

          const handleVoiceInput = () => {
            if (!('webkitSpeechRecognition' in window)) { alert("Voice input requires Chrome."); return; }
            const recognition = new window.webkitSpeechRecognition();
            recognition.continuous = false; recognition.lang = 'en-US';
            recognition.onstart = () => setIsListening(true);
            recognition.onend = () => setIsListening(false);
            recognition.onresult = (e) => setInput(prev => prev + (prev ? ' ' : '') + e.results[0][0].transcript);
            recognition.start();
          };

          const handleSend = async (textOverride = null) => {
              const textToSend = textOverride || input;
              if ((!textToSend.trim() && !selectedImage) || isStreaming) return;
              
              const imagePayload = selectedImage;
              setInput(''); setSelectedImage(null); setIsStreaming(true);
              
              // Update UI
              const userMsg = { role: 'user', content: textToSend, images: imagePayload ? [imagePayload] : [] };
              let newTitle = currentSession.title;
              if (currentSession.messages.length === 0) newTitle = textToSend ? textToSend.substring(0, 30) : 'Image Analysis';

              let updatedSessions = sessions.map(s => s.id === activeId ? { ...s, messages: [...s.messages, userMsg], title: newTitle } : s);
              
              // Add placeholder
              updatedSessions = updatedSessions.map(s => s.id === activeId ? { ...s, messages: [...s.messages, { role: 'model', content: '' }] } : s);
              setSessions(updatedSessions);

              // Prepare Payload
              const contents = currentSession.messages.map(m => ({
                  role: m.role === 'user' ? 'user' : 'model',
                  parts: [...(m.images || []).map(img => ({ inlineData: { mimeType: img.split(';')[0].split(':')[1], data: img.split(',')[1] } })), { text: m.content || '' }]
              }));
              contents.push({ role: 'user', parts: [...(imagePayload ? [{ inlineData: { mimeType: imagePayload.split(';')[0].split(':')[1], data: imagePayload.split(',')[1] } }] : []), { text: textToSend }] });

              try {
                  const response = await fetch(API_URL, {
                      method: 'POST',
                      headers: { 'Content-Type': 'application/json' },
                      body: JSON.stringify({
                          contents,
                          systemInstruction: { parts: [{ text: "You are Bapkam.ai, created by P ARAVIND from India, Telangana, Narayanapet. Provide production-ready, well-commented Markdown code. Be concise, friendly, and smart." }] },
                          generationConfig: { temperature: 0.7, maxOutputTokens: 8000 }
                      })
                  });
                  if (!response.ok) throw new Error(response.status === 429 ? "Model busy. Retry." : "Connection Error.");
                  
                  const reader = response.body.getReader();
                  const decoder = new TextDecoder();
                  let assistantText = '';

                  while (true) {
                      const { done, value } = await reader.read();
                      if (done) break;
                      const chunk = decoder.decode(value, { stream: true });
                      const matchText = /"text":\s*"((?:[^"\\]|\\.)*)"/g;
                      let match;
                      while ((match = matchText.exec(chunk)) !== null) {
                           try { assistantText += JSON.parse(`"${match[1]}"`); } catch(e) {}
                      }
                      setSessions(prev => prev.map(s => s.id === activeId ? { ...s, messages: [...s.messages.slice(0, -1), { role: 'model', content: assistantText }] } : s));
                  }
              } catch (error) {
                  setSessions(prev => prev.map(s => s.id === activeId ? { ...s, messages: [...s.messages.slice(0, -1), { role: 'model', content: `‚ö†Ô∏è ${error.message}` }] } : s));
              } finally { setIsStreaming(false); }
          };

          if (!isLoggedIn) {
              return (
                  <div className="h-full w-full flex flex-col items-center justify-center p-6 bg-white relative overflow-hidden">
                      <div className="absolute top-0 left-0 w-96 h-96 bg-indigo-100 rounded-full blur-3xl opacity-50 -translate-x-1/2 -translate-y-1/2 animate-pulse-slow"></div>
                      <div className="absolute bottom-0 right-0 w-96 h-96 bg-pink-100 rounded-full blur-3xl opacity-50 translate-x-1/2 translate-y-1/2 animate-pulse-slow"></div>
                      <div className="z-10 flex flex-col items-center text-center max-w-md w-full animate-fade-in-up">
                          <div className="w-20 h-20 mb-8 bg-white border border-slate-100 rounded-3xl shadow-xl flex items-center justify-center"><SparklesIcon className="w-10 h-10 text-indigo-600" /></div>
                          <h1 className="text-4xl font-bold text-slate-900 mb-2">bapkam.ai</h1>
                          <p className="text-slate-500 mb-10 text-lg">Your intelligent companion.</p>
                          <button onClick={() => setIsLoggedIn(true)} className="w-full flex items-center justify-center gap-3 px-8 py-4 bg-slate-900 text-white rounded-2xl font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all">Log in to Chat <Icon d="M5 12h14M12 5l7 7-7 7" className="w-5 h-5" /></button>
                      </div>
                  </div>
              );
          }
          
          const isNewChat = currentSession.messages.length === 0;
          return (
              <div className="flex h-full w-full bg-white text-slate-900 font-sans">
                  {/* Sidebar */}
                  {isSidebarOpen && <div className="fixed inset-0 bg-black/20 z-30 lg:hidden backdrop-blur-sm" onClick={() => setIsSidebarOpen(false)}></div>}
                  <aside className={`fixed lg:relative inset-y-0 left-0 w-[280px] bg-slate-50 border-r border-slate-200 z-40 transition-transform duration-300 ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} lg:translate-x-0 flex flex-col`}>
                      <div className="p-4 flex items-center justify-between">
                          <div className="flex items-center gap-2 font-bold text-lg text-slate-800"><div className="w-8 h-8 bg-white border border-slate-200 rounded-lg flex items-center justify-center shadow-sm"><SparklesIcon className="w-4 h-4 text-indigo-600"/></div>bapkam</div>
                          <button onClick={() => setIsSidebarOpen(false)} className="lg:hidden p-2 hover:bg-slate-200 rounded-lg"><CloseIcon className="w-5 h-5"/></button>
                      </div>
                      <div className="px-4 pb-4"><button onClick={createSession} className="w-full flex items-center gap-3 px-4 py-3 bg-white border border-slate-200 hover:border-indigo-300 rounded-xl transition-all text-sm font-medium text-slate-700 group"><div className="bg-indigo-50 text-indigo-600 p-1 rounded-md group-hover:bg-indigo-600 group-hover:text-white transition-colors"><PlusIcon className="w-4 h-4"/></div>New Chat</button></div>
                      <div className="flex-1 overflow-y-auto px-2 custom-scroll">{sessions.map(s => <button key={s.id} onClick={() => { setActiveId(s.id); if(window.innerWidth<1024) setIsSidebarOpen(false); }} className={`w-full text-left px-4 py-2.5 rounded-lg text-sm truncate mb-1 ${activeId===s.id ? 'bg-white shadow-sm text-indigo-700 font-medium' : 'text-slate-600 hover:bg-slate-100'}`}>{s.title}</button>)}</div>
                      <div className="p-4 border-t border-slate-200"><button onClick={() => setIsLoggedIn(false)} className="flex items-center gap-3 w-full px-3 py-2 hover:bg-slate-100 rounded-lg text-sm font-medium text-slate-600"><div className="w-8 h-8 bg-indigo-600 rounded-full text-white flex items-center justify-center text-xs font-bold">P</div><div className="flex-1 text-left"><div>User</div><div className="text-xs text-slate-400">Pro Plan</div></div></button></div>
                  </aside>
                  {/* Main */}
                  <main className="flex-1 flex flex-col h-full relative min-w-0">
                      <header className="h-14 flex items-center justify-between px-4 bg-white/80 backdrop-blur-md sticky top-0 z-20">
                          <div className="flex items-center gap-3"><button onClick={() => setIsSidebarOpen(true)} className="lg:hidden p-2 hover:bg-slate-100 rounded-lg"><MenuIcon className="w-6 h-6"/></button><span className="font-semibold text-slate-700 lg:hidden">bapkam.ai</span></div>
                          <div className="hidden lg:flex items-center gap-2 px-3 py-1 bg-slate-100 rounded-full border border-slate-200"><span className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span><span className="font-medium text-slate-600 text-xs">Gemini 2.0 Flash</span></div>
                      </header>
                      <div className="flex-1 overflow-y-auto custom-scroll scroll-smooth" ref={chatRef}>
                          {isNewChat ? (
                              <div className="max-w-3xl mx-auto px-6 pt-10 pb-10 flex flex-col items-center animate-fade-in-up">
                                  <div className="mb-6 p-4 bg-white rounded-full shadow-sm border border-slate-100"><SparklesIcon className="w-8 h-8 text-indigo-600" /></div>
                                  <h2 className="text-2xl md:text-3xl font-semibold text-slate-900 mb-2 text-center">Good {new Date().getHours() < 12 ? "Morning" : new Date().getHours() < 18 ? "Afternoon" : "Evening"}, User</h2>
                                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 w-full max-w-2xl mt-8">
                                      <SuggestionCard icon={ImageUploadIcon} text="Analyze an image" onClick={() => fileInputRef.current.click()} />
                                      <SuggestionCard icon={CodeIcon} text="Write a Python script" onClick={() => handleSend("Write a Python script for a To-Do list app.")} />
                                      <SuggestionCard icon={SearchIcon} text="Explain Quantum Computing" onClick={() => handleSend("Explain Quantum Computing simply.")} />
                                      <SuggestionCard icon={SparklesIcon} text="Write a Story" onClick={() => handleSend("Write a short sci-fi story.")} />
                                  </div>
                              </div>
                          ) : (
                              <div className="max-w-3xl mx-auto px-4 py-6">{currentSession.messages.map((m, i) => <ChatMessage key={i} msg={m} />)}</div>
                          )}
                      </div>
                      <div className="p-4 bg-white">
                          <div className="max-w-3xl mx-auto relative">
                              {selectedImage && <div className="absolute bottom-full left-0 mb-4 p-2 bg-white border border-slate-200 rounded-xl shadow-lg animate-fade-in z-10"><img src={selectedImage} className="h-24 rounded-lg" /><button onClick={() => setSelectedImage(null)} className="absolute -top-2 -right-2 bg-slate-800 text-white rounded-full p-1"><CloseIcon className="w-3 h-3"/></button></div>}
                              <div className="flex items-end gap-2 p-2 bg-slate-50 border border-slate-200 rounded-[26px] shadow-sm focus-within:bg-white transition-all">
                                  <input type="file" ref={fileInputRef} onChange={handleFileChange} className="hidden" accept="image/*" />
                                  <button onClick={() => fileInputRef.current.click()} className="p-3 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-full flex-shrink-0"><PlusIcon className="w-6 h-6" /></button>
                                  <textarea ref={inputRef} value={input} onChange={(e) => setInput(e.target.value)} onKeyDown={(e) => { if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSend();}}} placeholder="Message Bapkam..." className="flex-1 bg-transparent border-none outline-none text-slate-800 py-3 max-h-32 resize-none font-sans text-[15px]" rows={1} />
                                  <button onClick={handleVoiceInput} className={`p-3 rounded-full flex-shrink-0 transition-colors ${isListening?'bg-red-100 text-red-600 animate-pulse':'text-slate-400 hover:text-indigo-600'}`}><MicIcon className="w-6 h-6" /></button>
                                  <button onClick={() => handleSend()} disabled={!input.trim() && !selectedImage} className={`p-3 rounded-full flex-shrink-0 transition-all ${(input.trim() || selectedImage) ? 'bg-slate-900 text-white shadow-md hover:bg-black' : 'bg-slate-200 text-slate-400'}`}><SendIcon className="w-5 h-5" /></button>
                              </div>
                              <p className="text-[10px] text-slate-400 text-center mt-2">AI can make mistakes.</p>
                          </div>
                      </div>
                  </main>
              </div>
          );
      };
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>